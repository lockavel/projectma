# projectma

# 人马工程说明文档

## 一、目的

​	该项目通过系统化的对于外包工程或者其他情景做出归纳，目前的时代是一个网络终端的依赖，大部分的人是是足不出户查看信息，如果能通过一个系统看到自己投资（或者组建、提议的工程），就不需要在通过邮箱、微信等途径，零散的查看信息，从本质上节约了时间，适应与当代社会的发展。

## 二、背景

1.本数据库使用Mysql数据库搭建，用于人马工程的数据管理

2.数据库名称：projectma

3.系统名称：人马工程

4.项目经理：刘海龙

5.开发者：李鸿祥 陶柚宏 王锐 李明禹

6.用户：各种项目的参与者

## 三、外部设计

### 3.1主键和描述

数据库软件名称：Mysql 5.7

数据名称：renma

| 表明            | 主键          | 描述信息               |
| --------------- | ------------- | ---------------------- |
| user表          | userid        | 用来保存用户信息       |
| project表       | projectid     | 用来记录项目信息       |
| requirement表   | requirementid | 用来记录工作要求信息   |
| member表        | 无            | 用来记录项目及成员信息 |
| progress表      | 无            | 用来记录项目及其进度   |
| image表         | imageid       | 用来存放图片           |
| reimbursement表 | reid          | 用来存放报销信息       |
| sgin表          | 无            | 用来记录员工的签到信息 |

### 3.2使用它的程序

| 应用程序         | 访问的数据表                                | 版本号 |
| ---------------- | ------------------------------------------- | ------ |
| 登陆系统         | user表                                      | 1.0    |
| 创建项目         | user表，project表                           | 1.0    |
| 工作要求系统     | project表，user表，rquirement表             | 1.0    |
| 项目选择系统     | user表，project表                           | 1.0    |
| 加入项目         | user表，project表，member表                 | 1.0    |
| 工作进度查询     | project表、progress表                       | 1.0    |
| 额外支出报备系统 | user表，project表，image表、reimbursement表 | 1.0    |
| 额外支出审批系统 | user表，project表、reimbursement表          | 1.0    |
| 项目成员管理     | user表，project表，member表                 | 1.0    |
| 签到系统         | user表，project表，sgin表                   | 1.0    |
| 工资查询         | user表，project表，sgin表                   | 1.0    |

### 3.3开发环境

| 开发工具 | 版本  | 主要功能                               |
| -------- | ----- | -------------------------------------- |
| Mysql    | 5.7   | 建立数据库并提供数据库维护与管理功能   |
| ssm      | 2.7.1 | 后端框架，为小程序提供数据库的技术支持 |
| java     | 11.0  | 代码编写                               |
| navicat  |       | 管理员工具                             |
| postman  |       | 测试工具                               |
| idea     |       | 后端代码编写                           |

## 四、结构设计

### 4.1用例分析

| 用例编号   | UC01                                         |      |
| ---------- | -------------------------------------------- | ---- |
| 用例名称   | 注册与登录                                   |      |
| 用例概述   | 用户的登录与注册验证                         |      |
| 主参与者   | 项目参与者                                   |      |
| 前置条件   | 在数据库中查询或插入用户信息                 |      |
| 后置条件   | 根据在数据库中的信息展示用户所参与的所有项目 |      |
| 基本事件流 | 步骤                                         | 活动 |
| 1          | 用户进入登录系统                             |      |
| 2          | 用户进行注册或登录                           |      |
| 3          | 用户验证                                     |      |
| 4          | 展示用户参与的项目                           |      |
| 异常处理   | 用户登录失败、或与网络断开连接则无法进入系统 |      |

 

| 用例编号   | UC02                                                         |      |
| ---------- | ------------------------------------------------------------ | ---- |
| 用例名称   | 创建项目                                                     |      |
| 用例概述   | 用户创建一个自己投资的项目                                   |      |
| 主参与者   | 项目参与者                                                   |      |
| 前置条件   | 用户填完项目相关的信息并点击创建                             |      |
| 后置条件   | 在数据库中新建一个项目                                       |      |
| 基本事件流 | 步骤                                                         | 活动 |
| 1          | 用户进入创建项目系统                                         |      |
| 2          | 用户填写项目相关信息                                         |      |
| 3          | 项目审核验证                                                 |      |
| 4          | 创建项目成功，并将该用户标记为项目投资人，告诉该用户此项目的项目ID |      |
| 异常处理   | 若用户填写的项目信息不完整、或该用户不具备投资人的条件，则该项目不予创建。 |      |

 

| 用例编号   | UC03                                                         |      |
| ---------- | ------------------------------------------------------------ | ---- |
| 用例名称   | 工作要求                                                     |      |
| 用例概述   | 用户查询某一个自己参加项目的工作要求                         |      |
| 主参与者   | 项目参与者                                                   |      |
| 前置条件   | 用户加入该项目                                               |      |
| 后置条件   | 根据用户在该项目中扮演的不同角色提供不同的功能               |      |
| 基本事件流 | 步骤                                                         | 活动 |
| 1          | 用户选择项目并选择工作要求                                   |      |
| 2          | 用户在该项目中的角色验证                                     |      |
| 3          | 若该用户的角色为：项目投资人则提供查询与更改工作要求的功能   |      |
| 4          | 若该角色为其他角色：提供查询工作要求的功能                   |      |
| 异常处理   | 若项目投资人在提交更改后的工作要求时断开网络连接，则无法修改 |      |

 

| 用例编号   | UC04                                                         |      |
| ---------- | ------------------------------------------------------------ | ---- |
| 用例名称   | 项目选择                                                     |      |
| 用例概述   | 用户选择自己参加的项目                                       |      |
| 主参与者   | 项目参与者                                                   |      |
| 前置条件   | 用户存在于某个项目                                           |      |
| 后置条件   | 根据用户在该项目中扮演的角色不同提供不同的功能界面           |      |
| 基本事件流 | 步骤                                                         | 活动 |
| 1          | 用户选择一个已加入的项目                                     |      |
| 2          | 用户在该项目中的角色验证                                     |      |
| 3          | 若用户为项目的投资人：提供项目需求查询与更改、意见咨询、项目信息管理等功能 |      |
| 4          | 若用户为项目管理者：提供各项目小组信息查询与更改、各项目小组支出报备、项目施工进度查询与更改、传达工作要求等功能 |      |
| 5          | 若用户为项目小组组长：提供工作要求查看、成员信息管理、上传额外开销、工资明细等功能 |      |
| 异常处理   | 无                                                           |      |

 

| 用例编号   | UC05                                                         |      |
| ---------- | ------------------------------------------------------------ | ---- |
| 用例名称   | 加入项目                                                     |      |
| 用例概述   | 用户选择预加入的项目                                         |      |
| 主参与者   | 项目管理者、项目小组长、项目小组组员                         |      |
| 前置条件   | 用户填写自己的信息与加入项目的ID                             |      |
| 后置条件   | 将用户填写的不同信息提交给项目中不同的管理员（投资人、管理者、小组长） |      |
| 基本事件流 | 步骤                                                         | 活动 |
| 1          | 用户提交相关信息                                             |      |
| 2          | 验证用户填写信息中预扮演的角色                               |      |
| 3          | 若用户为项目的管理者：将相关信息提供给项目投资人审核         |      |
| 4          | 若用户为项目的项目小组长：将相关信息提供给项目管理者审核     |      |
| 5          | 若用户为项目小组组员：将相关信息提供给项目小组组长审核       |      |
| 异常处理   | 若项目不存在管理者且有人申请成为小组长或小组组员，则提示该“项目不存在 上级信息，申请提交失败！” |      |

 

| 用例编号   | UC06                                                     |      |
| ---------- | -------------------------------------------------------- | ---- |
| 用例名称   | 工作进度查询                                             |      |
| 用例概述   | 用户查询自己管理的项目部分的工作进度                     |      |
| 主参与者   | 项目投资人、项目管理者、项目小组长                       |      |
| 前置条件   | 用户在该项目中承担管理员角色                             |      |
| 后置条件   | 根据用户在该项目中扮演的角色不同提供不同的查询界面       |      |
| 基本事件流 | 步骤                                                     | 活动 |
| 1          | 管理员进入工作进度查询系统                               |      |
| 2          | 用户在该项目中的管理员角色验证                           |      |
| 3          | 若用户为项目的投资人：提供整个项目的所有部分工作进度查询 |      |
| 4          | 若用户为项目管理者：提供各小组的工作进度查询             |      |
| 5          | 若用户为项目小组组长：提供本小组的工作进度查询           |      |
| 异常处理   | 无                                                       |      |

 

| 用例编号   | UC07                                       |      |
| ---------- | ------------------------------------------ | ---- |
| 用例名称   | 额外支出报备                               |      |
| 用例概述   | 用户上传自己的额外支出                     |      |
| 主参与者   | 项目小组长                                 |      |
| 前置条件   | 用户为项目小组长                           |      |
| 后置条件   | 将报备信息上传给项目管理者待项目管理者审核 |      |
| 基本事件流 | 步骤                                       | 活动 |
| 1          | 用户进入额外支出报备系统                   |      |
| 2          | 用户填写相关信息                           |      |
| 3          | 将填写信息提交给项目管理者待其审批         |      |
| 异常处理   | 若提交时断开网络则提交失败                 |      |

 

| 用例编号   | UC08                           |      |
| ---------- | ------------------------------ | ---- |
| 用例名称   | 额外支出审批                   |      |
| 用例概述   | 用户审批小组长上传的额外支出   |      |
| 主参与者   | 项目管理者                     |      |
| 前置条件   | 用户为项目管理者               |      |
| 后置条件   | 将相关审批信息回传给项目小组长 |      |
| 基本事件流 | 步骤                           | 活动 |
| 1          | 用户进入额外支出审批系统       |      |
| 2          | 展示相关审批信息               |      |
| 3          | 是否通过该审批                 |      |
| 4          | 返回审批结果                   |      |
| 异常处理   | 若返回结果时断开网络则返回失败 |      |



| 用例编号   | UC09                                                         |      |
| ---------- | ------------------------------------------------------------ | ---- |
| 用例名称   | 项目成员管理                                                 |      |
| 用例概述   | 用户管理自己手下的人员                                       |      |
| 主参与者   | 项目管理者、项目小组长                                       |      |
| 前置条件   | 用户为上述参与者                                             |      |
| 后置条件   | 管理相关人员信息并将其信息保存到数据库                       |      |
| 基本事件流 | 步骤                                                         | 活动 |
| 1          | 用户进入项目成员管理系统                                     |      |
| 2          | 验证用户身份                                                 |      |
| 3          | 若用户为项目管理者：提供各小组创建、各小组组长的审核、小组长更换等功能 |      |
| 4          | 若用户为项目小组长：提供该小组成员的审核、剔除等功能         |      |
| 异常处理   | 若提交时断开网络则提交失败                                   |      |

| 用例编号   | UC10                                                         |      |
| ---------- | ------------------------------------------------------------ | ---- |
| 用例名称   | 签到管理                                                     |      |
| 用例概述   | 用户管理自己手下签到信息                                     |      |
| 主参与者   | 项目管理者、项目小组长                                       |      |
| 前置条件   | 用户为上述参与者                                             |      |
| 后置条件   | 管理相关人员签到信息并将其信息保存到数据库                   |      |
| 基本事件流 | 步骤                                                         | 活动 |
| 1          | 用户进入签到管理系统                                         |      |
| 2          | 验证用户身份                                                 |      |
| 3          | 若用户为项目管理者：提供各小组的签到信息查看，小组长工资扣除等功能 |      |
| 4          | 若用户为项目小组长：提供该小组成员的每日签到功能，及扣除工资等功能 |      |
| 异常处理   | 若提交时断开网络则提交失败                                   |      |

 

| 用例编号   | UC11                               |      |
| ---------- | ---------------------------------- | ---- |
| 用例名称   | 工资明细                           |      |
| 用例概述   | 用户查看自己的工资明细             |      |
| 主参与者   | 项目小组长，项目小组组员           |      |
| 前置条件   | 用户为上述参与者                   |      |
| 后置条件   | 从数据库中查询相关信息并展示给用户 |      |
| 基本事件流 | 步骤                               | 活动 |
| 1          | 用户进入项目工资明细系统           |      |
| 2          | 展示工资明细                       |      |
| 异常处理   | 无                                 |      |

### 4.2全局E-R图

![ER](C:\Users\admin\Desktop\半人马座α星殖民先遣队\${imgs}\ER-1653722203803.jpg)

### 4.3逻辑结构设计

user表

| 字段名   | 数据类型 | 长度 | 主键 | 非空 | 描述               |
| -------- | -------- | ---- | ---- | ---- | ------------------ |
| uerid    | int      | 11   | 是   | 是   | 用户id             |
| password | varchar  | 255  | 否   | 是   | 密码               |
| name     | varchar  | 255  | 否   | 是   | 姓名               |
| tel      | varchar  | 255  | 否   | 是   | 电话               |
| sex      | int      | 11   | 否   | 是   | 性别（0-男、1-女） |
| imageid  | int      | 11   | 否   | 是   | 图片               |

project表

| 字段名      | 数据类型 | 长度 | 主键 | 非空 | 描述                           |
| ----------- | -------- | ---- | ---- | ---- | ------------------------------ |
| projectid   | int      | 11   | 是   | 是   | 项目id                         |
| projectname | varchar  | 255  | 否   | 是   | 项目名称                       |
| createrid   | int      | 11   | 否   | 是   | 创建人id                       |
| state       | int      | 11   | 否   | 是   | 项目状态（0-正在施工、1-竣工） |
| imageid     | int      | 11   | 否   | 否   | 图片                           |
| price       | decimal  | 10   | 否   | 是   | 工程报价                       |

requirement表

| 字段名        | 数据类型 | 长度 | 主键 | 非空 | 描述         |
| ------------- | -------- | ---- | ---- | ---- | ------------ |
| requirementid | int      | 11   | 是   | 是   | 项目id       |
| projectid     | int      | 11   |      | 是   | 项目id       |
| message       | varchar  | 255  |      | 是   | 要求的信息   |
| office        | int      | 11   |      | 是   | 发布人的职务 |
| imageid       | int      | 11   |      | 否   | 图片         |
| userid        | int      | 11   |      | 是   | 发布人的id   |

member表

| 字段名    | 数据类型 | 长度 | 主键 | 非空 | 描述                                                         |
| --------- | -------- | ---- | ---- | ---- | ------------------------------------------------------------ |
| userid    | int      | 11   | 否   | 是   | 用户id                                                       |
| projectid | int      | 11   | 否   | 是   | 所属项目id                                                   |
| office    | int      | 11   | 否   | 是   | 该用户在该项目中的职务（4-创建者、3-承包商、2-组长、3-员工） |

progress表

| 字段名    | 数据类型 | 长度 | 主键 | 非空 | 描述         |
| --------- | -------- | ---- | ---- | ---- | ------------ |
| projectid | int      | 11   | 是   | 是   | 项目id       |
| stage     | varchar  | 255  |      | 是   | 阶段名称     |
| task      | varchar  | 255  |      | 是   | 该阶段的任务 |
| pace      | decimal  | 10   |      | 是   | 完成度       |
| imageid   | int      | 11   |      | 是   | 图片         |

image表

| 字段名     | 数据类型 | 长度 | 主键 | 非空 | 描述                               |
| ---------- | -------- | ---- | ---- | ---- | ---------------------------------- |
| imageid    | int      | 11   | 是   | 是   | 图片id                             |
| imageurl   | varchar  | 255  |      | 是   | 图片的路径                         |
| imagestate | int      | 11   |      | 是   | 是否启用该图片（0-未启用、1-启用） |

reimbursement表

| 字段名      | 数据类型 | 长度 | 主键 | 非空 | 描述                              |
| ----------- | -------- | ---- | ---- | ---- | --------------------------------- |
| reid        | int      | 11   | 是   | 是   | 报账id                            |
| imageid     | int      | 11   |      | 是   | 阶段名称                          |
| name        | varchar  | 255  |      | 是   | 报账人姓名                        |
| description | varchar  | 255  |      | 否   | 描述                              |
| state       | varchar  | 255  |      | 是   | 状态（0-未通过/正在审批、1-通过） |
| money       | decimal  | 10   |      | 是   | 报账金额                          |

sgin表

| 字段名    | 数据类型 | 长度 | 主键 | 非空 | 描述     |
| --------- | -------- | ---- | ---- | ---- | -------- |
| userid    | int      | 11   | 否   | 是   | 用户id   |
| projectid | int      | 11   | 否   | 是   | 项目id   |
| name      | varchar  | 255  | 否   | 是   | 姓名     |
| salary    | decimal  | 10   | 否   | 是   | 日薪     |
| days      | int      | 11   | 否   | 是   | 签到天数 |

### 4.4物理结构设计

见文件ranma.sql
